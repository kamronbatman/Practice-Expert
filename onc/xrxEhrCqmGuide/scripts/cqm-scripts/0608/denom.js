var cqmGuideController = require("../../../controllers/cqmGuideController.js");
module.exports = function (patId, fromDate, toDate, dctId, fclId, callback) {

  var sql1 = "select PatId from xrxPat pat \
               where ( \
                 (PatId = '"+patId+"') \
                 and (pat.Birthdate is not null) \
                 and ((select dbo.xrxGetPatAge(pat.Birthdate,null, '"+fromDate+"')) >= 12) \
                 and (pat.Sex is not null) and (pat.Sex = 'F') \
              )";

  var sql2 = "select cqm.PatId \
              from xrxEhr_Cqm cqm \
              inner join \
              ( \
                  select cqm.PatId, max(DateOfVisit) as DateOfVisit \
                  from xrxEhr_Cqm cqm \
                  where \
                  (  \
                		(cqm.ReasonCode is null) \
                		and \
                		( \
                			cqm.Code = '10745001' or cqm.Code = '14119008' or cqm.Code = '15413009' or cqm.Code = '16819009' or cqm.Code = '177152009' or cqm.Code = '177157003' or cqm.Code = '177158008' or cqm.Code = '177161009' or cqm.Code = '177162002' or cqm.Code = '177164001' or cqm.Code = '177167008' or cqm.Code = '177168003' or cqm.Code = '177170007' or cqm.Code = '177173009' or cqm.Code = '177174003' or cqm.Code = '177175002' or cqm.Code = '177176001' or cqm.Code = '177179008' or cqm.Code = '177180006' or cqm.Code = '177181005' or cqm.Code = '177184002' or cqm.Code = '177185001' or cqm.Code = '177203002' or cqm.Code = '177204008' or cqm.Code = '177212000' or cqm.Code = '17860005' or cqm.Code = '1807002' or cqm.Code = '18625004' or cqm.Code = '19390001' or cqm.Code = '22633006' or cqm.Code = '2321005' or cqm.Code = '236973005' or cqm.Code = '236974004' or cqm.Code = '236975003' or cqm.Code = '236976002' or cqm.Code = '236977006' or cqm.Code = '236978001' or cqm.Code = '236980007' or cqm.Code = '236981006' or cqm.Code = '236982004' or cqm.Code = '236983009' or cqm.Code = '236984003' or cqm.Code = '236991000' or cqm.Code = '236994008' or cqm.Code = '237311001' or cqm.Code = '25296001' or cqm.Code = '25828002' or cqm.Code = '26313002' or cqm.Code = '265639000' or cqm.Code = '275168001' or cqm.Code = '275169009' or cqm.Code = '28542003' or cqm.Code = '287976008' or cqm.Code = '287977004' or cqm.Code = '288193006' or cqm.Code = '28860009' or cqm.Code = '29613008' or cqm.Code = '302382009' or cqm.Code = '302383004' or cqm.Code = '302384005' or cqm.Code = '30476003' or cqm.Code = '306727001' or cqm.Code = '33807004' or cqm.Code = '359940006' or cqm.Code = '359943008' or cqm.Code = '384729004' or cqm.Code = '384730009' or cqm.Code = '38479009' or cqm.Code = '40219000' or cqm.Code = '40704000' or cqm.Code = '40792007' or cqm.Code = '416055001' or cqm.Code = '417121007' or cqm.Code = '4504004' or cqm.Code = '450798003' or cqm.Code = '45718005' or cqm.Code = '46972000' or cqm.Code = '48204000' or cqm.Code = '5191001' or cqm.Code = '54973000' or cqm.Code = '5556001' or cqm.Code = '56620000' or cqm.Code = '58705005' or cqm.Code = '61027002' or cqm.Code = '61586001' or cqm.Code = '62508004' or cqm.Code = '62688006' or cqm.Code = '65243006' or cqm.Code = '66201006' or cqm.Code = '69162008' or cqm.Code = '69422002' or cqm.Code = '69621003' or cqm.Code = '71166009' or cqm.Code = '72492007' or cqm.Code = '75928003' or cqm.Code = '85403009' or cqm.Code = '89346004' or cqm.Code = '89849000' or cqm.Code = '90438006' or cqm.Code = '10A07ZZ' or cqm.Code = '10A08ZZ' or cqm.Code = '10D00Z0' or cqm.Code = '10D00Z1' or cqm.Code = '10D00Z2' or cqm.Code = '10D07Z3' or cqm.Code = '10D07Z4' or cqm.Code = '10D07Z5' or cqm.Code = '10D07Z6' or cqm.Code = '10D07Z7' or cqm.Code = '10D07Z8' or cqm.Code = '10E0XZZ' or cqm.Code = '72.0' or cqm.Code = '72.1' or cqm.Code = '72.21' or cqm.Code = '72.29' or cqm.Code = '72.31' or cqm.Code = '72.39' or cqm.Code = '72.4' or cqm.Code = '72.51' or cqm.Code = '72.52' or cqm.Code = '72.53' or cqm.Code = '72.54' or cqm.Code = '72.6' or cqm.Code = '72.71' or cqm.Code = '72.79' or cqm.Code = '72.8' or cqm.Code = '72.9' or cqm.Code = '73.01' or cqm.Code = '73.09' or cqm.Code = '73.1' or cqm.Code = '73.21' or cqm.Code = '73.22' or cqm.Code = '73.3' or cqm.Code = '73.4' or cqm.Code = '73.51' or cqm.Code = '73.59' or cqm.Code = '73.6' or cqm.Code = '73.8' or cqm.Code = '73.91' or cqm.Code = '73.92' or cqm.Code = '73.93' or cqm.Code = '73.94' or cqm.Code = '73.99' or cqm.Code = '74.0' or cqm.Code = '74.1' or cqm.Code = '74.2' or cqm.Code = '74.4' or cqm.Code = '74.99' or cqm.Code = '59400' or cqm.Code = '59409' or cqm.Code = '59410' or cqm.Code = '59510' or cqm.Code = '59514' or cqm.Code = '59515' or cqm.Code = '59610' or cqm.Code = '59612' or cqm.Code = '59614' or cqm.Code = '59618' or cqm.Code = '59620' or cqm.Code = '59622' \
                		) \
                		and (cqm.DateOfVisit>= '"+fromDate+"') and (cqm.DateOfVisit<= '"+toDate+"') and  (isNull(cqm.FclId, '') = case when ('"+fclId+"' = '')  then isNull(cqm.FclId, '') else '"+fclId+"' end) and  (isNull(cqm.DctId, '') = case when ('"+dctId+"' = '')  then isNull(cqm.DctId, '') else '"+dctId+"' end) \
                  ) \
                  group by PatId \
              ) cqm2 \
              on cqm.PatId = cqm2.PatId and cqm.DateOfVisit = cqm2.DateOfVisit \
              where \
              ( \
              	(cqm.PatId = '"+patId+"') \
              	and \
              	( \
              		cqm.Code = '10745001' or cqm.Code = '14119008' or cqm.Code = '15413009' or cqm.Code = '16819009' or cqm.Code = '177152009' or cqm.Code = '177157003' or cqm.Code = '177158008' or cqm.Code = '177161009' or cqm.Code = '177162002' or cqm.Code = '177164001' or cqm.Code = '177167008' or cqm.Code = '177168003' or cqm.Code = '177170007' or cqm.Code = '177173009' or cqm.Code = '177174003' or cqm.Code = '177175002' or cqm.Code = '177176001' or cqm.Code = '177179008' or cqm.Code = '177180006' or cqm.Code = '177181005' or cqm.Code = '177184002' or cqm.Code = '177185001' or cqm.Code = '177203002' or cqm.Code = '177204008' or cqm.Code = '177212000' or cqm.Code = '17860005' or cqm.Code = '1807002' or cqm.Code = '18625004' or cqm.Code = '19390001' or cqm.Code = '22633006' or cqm.Code = '2321005' or cqm.Code = '236973005' or cqm.Code = '236974004' or cqm.Code = '236975003' or cqm.Code = '236976002' or cqm.Code = '236977006' or cqm.Code = '236978001' or cqm.Code = '236980007' or cqm.Code = '236981006' or cqm.Code = '236982004' or cqm.Code = '236983009' or cqm.Code = '236984003' or cqm.Code = '236991000' or cqm.Code = '236994008' or cqm.Code = '237311001' or cqm.Code = '25296001' or cqm.Code = '25828002' or cqm.Code = '26313002' or cqm.Code = '265639000' or cqm.Code = '275168001' or cqm.Code = '275169009' or cqm.Code = '28542003' or cqm.Code = '287976008' or cqm.Code = '287977004' or cqm.Code = '288193006' or cqm.Code = '28860009' or cqm.Code = '29613008' or cqm.Code = '302382009' or cqm.Code = '302383004' or cqm.Code = '302384005' or cqm.Code = '30476003' or cqm.Code = '306727001' or cqm.Code = '33807004' or cqm.Code = '359940006' or cqm.Code = '359943008' or cqm.Code = '384729004' or cqm.Code = '384730009' or cqm.Code = '38479009' or cqm.Code = '40219000' or cqm.Code = '40704000' or cqm.Code = '40792007' or cqm.Code = '416055001' or cqm.Code = '417121007' or cqm.Code = '4504004' or cqm.Code = '450798003' or cqm.Code = '45718005' or cqm.Code = '46972000' or cqm.Code = '48204000' or cqm.Code = '5191001' or cqm.Code = '54973000' or cqm.Code = '5556001' or cqm.Code = '56620000' or cqm.Code = '58705005' or cqm.Code = '61027002' or cqm.Code = '61586001' or cqm.Code = '62508004' or cqm.Code = '62688006' or cqm.Code = '65243006' or cqm.Code = '66201006' or cqm.Code = '69162008' or cqm.Code = '69422002' or cqm.Code = '69621003' or cqm.Code = '71166009' or cqm.Code = '72492007' or cqm.Code = '75928003' or cqm.Code = '85403009' or cqm.Code = '89346004' or cqm.Code = '89849000' or cqm.Code = '90438006' or cqm.Code = '10A07ZZ' or cqm.Code = '10A08ZZ' or cqm.Code = '10D00Z0' or cqm.Code = '10D00Z1' or cqm.Code = '10D00Z2' or cqm.Code = '10D07Z3' or cqm.Code = '10D07Z4' or cqm.Code = '10D07Z5' or cqm.Code = '10D07Z6' or cqm.Code = '10D07Z7' or cqm.Code = '10D07Z8' or cqm.Code = '10E0XZZ' or cqm.Code = '72.0' or cqm.Code = '72.1' or cqm.Code = '72.21' or cqm.Code = '72.29' or cqm.Code = '72.31' or cqm.Code = '72.39' or cqm.Code = '72.4' or cqm.Code = '72.51' or cqm.Code = '72.52' or cqm.Code = '72.53' or cqm.Code = '72.54' or cqm.Code = '72.6' or cqm.Code = '72.71' or cqm.Code = '72.79' or cqm.Code = '72.8' or cqm.Code = '72.9' or cqm.Code = '73.01' or cqm.Code = '73.09' or cqm.Code = '73.1' or cqm.Code = '73.21' or cqm.Code = '73.22' or cqm.Code = '73.3' or cqm.Code = '73.4' or cqm.Code = '73.51' or cqm.Code = '73.59' or cqm.Code = '73.6' or cqm.Code = '73.8' or cqm.Code = '73.91' or cqm.Code = '73.92' or cqm.Code = '73.93' or cqm.Code = '73.94' or cqm.Code = '73.99' or cqm.Code = '74.0' or cqm.Code = '74.1' or cqm.Code = '74.2' or cqm.Code = '74.4' or cqm.Code = '74.99' or cqm.Code = '59400' or cqm.Code = '59409' or cqm.Code = '59410' or cqm.Code = '59510' or cqm.Code = '59514' or cqm.Code = '59515' or cqm.Code = '59610' or cqm.Code = '59612' or cqm.Code = '59614' or cqm.Code = '59618' or cqm.Code = '59620' or cqm.Code = '59622' \
              	) \
              ) \
          ";

  var sql3 = "select cqm.PatId \
              from  xrxEhr_CQM cqm \
              where \
              ( \
                 (cqm.PatId = '"+patId+"') \
                 and \
	               ( \
		                 cqm.Code = '10745001' or cqm.Code = '11466000' or cqm.Code = '14119008' or cqm.Code = '15413009' or cqm.Code = '16819009' or cqm.Code = '177128002' or cqm.Code = '177141003' or cqm.Code = '177142005' or cqm.Code = '177143000' or cqm.Code = '177152009' or cqm.Code = '177157003' or cqm.Code = '177158008' or cqm.Code = '177161009' or cqm.Code = '177162002' or cqm.Code = '177164001' or cqm.Code = '177167008' or cqm.Code = '177168003' or cqm.Code = '177170007' or cqm.Code = '177173009' or cqm.Code = '177174003' or cqm.Code = '177175002' or cqm.Code = '177176001' or cqm.Code = '177179008' or cqm.Code = '177180006' or cqm.Code = '177181005' or cqm.Code = '177184002' or cqm.Code = '177203002' or cqm.Code = '17860005' or cqm.Code = '18625004' or cqm.Code = '19390001' or cqm.Code = '22633006' or cqm.Code = '236973005' or cqm.Code = '236974004' or cqm.Code = '236975003' or cqm.Code = '236976002' or cqm.Code = '236977006' or cqm.Code = '236978001' or cqm.Code = '236985002' or cqm.Code = '236986001' or cqm.Code = '236989008' or cqm.Code = '237311001' or cqm.Code = '25296001' or cqm.Code = '25828002' or cqm.Code = '26313002' or cqm.Code = '265639000' or cqm.Code = '274128005' or cqm.Code = '274129002' or cqm.Code = '274130007' or cqm.Code = '275168001' or cqm.Code = '275169009' or cqm.Code = '287976008' or cqm.Code = '29613008' or cqm.Code = '302382009' or cqm.Code = '302383004' or cqm.Code = '30476003' or cqm.Code = '306727001' or cqm.Code = '359940006' or cqm.Code = '359943008' or cqm.Code = '384729004' or cqm.Code = '38479009' or cqm.Code = '386622003' or cqm.Code = '387711001' or cqm.Code = '398307005' or cqm.Code = '40219000' or cqm.Code = '416055001' or cqm.Code = '417121007' or cqm.Code = '45718005' or cqm.Code = '54973000' or cqm.Code = '5556001' or cqm.Code = '57271003' or cqm.Code = '61586001' or cqm.Code = '62508004' or cqm.Code = '69162008' or cqm.Code = '69422002' or cqm.Code = '71166009' or cqm.Code = '72492007' or cqm.Code = '84195007' or cqm.Code = '85403009' or cqm.Code = '89053004' or cqm.Code = '89346004' or cqm.Code = '89849000' or cqm.Code = '90438006' or cqm.Code = '640.01' or cqm.Code = '640.81' or cqm.Code = '640.91' or cqm.Code = '641.01' or cqm.Code = '641.11' or cqm.Code = '641.21' or cqm.Code = '641.31' or cqm.Code = '641.81' or cqm.Code = '641.91' or cqm.Code = '642.01' or cqm.Code = '642.02' or cqm.Code = '642.11' or cqm.Code = '642.12' or cqm.Code = '642.21' or cqm.Code = '642.22' or cqm.Code = '642.31' or cqm.Code = '642.32' or cqm.Code = '642.41' or cqm.Code = '642.42' or cqm.Code = '642.51' or cqm.Code = '642.52' or cqm.Code = '642.61' or cqm.Code = '642.62' or cqm.Code = '642.71' or cqm.Code = '642.72' or cqm.Code = '642.91' or cqm.Code = '642.92' or cqm.Code = '643.01' or cqm.Code = '643.11' or cqm.Code = '643.21' or cqm.Code = '643.81' or cqm.Code = '643.91' or cqm.Code = '644.21' or cqm.Code = '645.11' or cqm.Code = '645.21' or cqm.Code = '646.01' or cqm.Code = '646.11' or cqm.Code = '646.12' or cqm.Code = '646.21' or cqm.Code = '646.22' or cqm.Code = '646.31' or cqm.Code = '646.41' or cqm.Code = '646.42' or cqm.Code = '646.51' or cqm.Code = '646.52' or cqm.Code = '646.61' or cqm.Code = '646.62' or cqm.Code = '646.71' or cqm.Code = '646.81' or cqm.Code = '646.82' or cqm.Code = '646.91' or cqm.Code = '647.01' or cqm.Code = '647.02' or cqm.Code = '647.11' or cqm.Code = '647.12' or cqm.Code = '647.21' or cqm.Code = '647.22' or cqm.Code = '647.31' or cqm.Code = '647.32' or cqm.Code = '647.41' or cqm.Code = '647.42' or cqm.Code = '647.51' or cqm.Code = '647.52' or cqm.Code = '647.61' or cqm.Code = '647.62' or cqm.Code = '647.81' or cqm.Code = '647.82' or cqm.Code = '647.91' or cqm.Code = '647.92' or cqm.Code = '648.01' or cqm.Code = '648.02' or cqm.Code = '648.11' or cqm.Code = '648.12' or cqm.Code = '648.21' or cqm.Code = '648.22' or cqm.Code = '648.31' or cqm.Code = '648.32' or cqm.Code = '648.41' or cqm.Code = '648.42' or cqm.Code = '648.51' or cqm.Code = '648.52' or cqm.Code = '648.61' or cqm.Code = '648.62' or cqm.Code = '648.71' or cqm.Code = '648.72' or cqm.Code = '648.81' or cqm.Code = '648.82' or cqm.Code = '648.91' or cqm.Code = '648.92' or cqm.Code = '649.01' or cqm.Code = '649.02' or cqm.Code = '649.11' or cqm.Code = '649.12' or cqm.Code = '649.21' or cqm.Code = '649.22' or cqm.Code = '649.31' or cqm.Code = '649.32' or cqm.Code = '649.41' or cqm.Code = '649.42' or cqm.Code = '649.51' or cqm.Code = '649.61' or cqm.Code = '649.62' or cqm.Code = '649.71' or cqm.Code = '649.81' or cqm.Code = '649.82' or cqm.Code = '650' or cqm.Code = '651.01' or cqm.Code = '651.11' or cqm.Code = '651.21' or cqm.Code = '651.31' or cqm.Code = '651.41' or cqm.Code = '651.51' or cqm.Code = '651.61' or cqm.Code = '651.71' or cqm.Code = '651.81' or cqm.Code = '651.91' or cqm.Code = '652.01' or cqm.Code = '652.11' or cqm.Code = '652.21' or cqm.Code = '652.31' or cqm.Code = '652.41' or cqm.Code = '652.51' or cqm.Code = '652.61' or cqm.Code = '652.71' or cqm.Code = '652.81' or cqm.Code = '652.91' or cqm.Code = '653.01' or cqm.Code = '653.11' or cqm.Code = '653.21' or cqm.Code = '653.31' or cqm.Code = '653.41' or cqm.Code = '653.51' or cqm.Code = '653.61' or cqm.Code = '653.71' or cqm.Code = '653.81' or cqm.Code = '653.91' or cqm.Code = '654.01' or cqm.Code = '654.02' or cqm.Code = '654.11' or cqm.Code = '654.12' or cqm.Code = '654.21' or cqm.Code = '654.31' or cqm.Code = '654.32' or cqm.Code = '654.41' or cqm.Code = '654.42' or cqm.Code = '654.51' or cqm.Code = '654.52' or cqm.Code = '654.61' or cqm.Code = '654.62' or cqm.Code = '654.71' or cqm.Code = '654.72' or cqm.Code = '654.81' or cqm.Code = '654.82' or cqm.Code = '654.91' or cqm.Code = '654.92' or cqm.Code = '655.01' or cqm.Code = '655.11' or cqm.Code = '655.21' or cqm.Code = '655.31' or cqm.Code = '655.41' or cqm.Code = '655.51' or cqm.Code = '655.61' or cqm.Code = '655.71' or cqm.Code = '655.81' or cqm.Code = '655.91' or cqm.Code = '656.01' or cqm.Code = '656.11' or cqm.Code = '656.21' or cqm.Code = '656.31' or cqm.Code = '656.51' or cqm.Code = '656.61' or cqm.Code = '656.71' or cqm.Code = '656.81' or cqm.Code = '656.91' or cqm.Code = '657.01' or cqm.Code = '658.01' or cqm.Code = '658.11' or cqm.Code = '658.21' or cqm.Code = '658.31' or cqm.Code = '658.41' or cqm.Code = '658.81' or cqm.Code = '658.91' or cqm.Code = '659.01' or cqm.Code = '659.11' or cqm.Code = '659.21' or cqm.Code = '659.31' or cqm.Code = '659.41' or cqm.Code = '659.51' or cqm.Code = '659.61' or cqm.Code = '659.71' or cqm.Code = '659.81' or cqm.Code = '659.91' or cqm.Code = '660.01' or cqm.Code = '660.11' or cqm.Code = '660.21' or cqm.Code = '660.31' or cqm.Code = '660.41' or cqm.Code = '660.51' or cqm.Code = '660.61' or cqm.Code = '660.71' or cqm.Code = '660.81' or cqm.Code = '660.91' or cqm.Code = '661.01' or cqm.Code = '661.11' or cqm.Code = '661.21' or cqm.Code = '661.31' or cqm.Code = '661.41' or cqm.Code = '661.91' or cqm.Code = '662.01' or cqm.Code = '662.11' or cqm.Code = '662.21' or cqm.Code = '662.31' or cqm.Code = '663.01' or cqm.Code = '663.11' or cqm.Code = '663.21' or cqm.Code = '663.31' or cqm.Code = '663.41' or cqm.Code = '663.51' or cqm.Code = '663.61' or cqm.Code = '663.81' or cqm.Code = '663.91' or cqm.Code = '664.01' or cqm.Code = '664.11' or cqm.Code = '664.21' or cqm.Code = '664.31' or cqm.Code = '664.41' or cqm.Code = '664.51' or cqm.Code = '664.61' or cqm.Code = '664.81' or cqm.Code = '664.91' or cqm.Code = '665.01' or cqm.Code = '665.11' or cqm.Code = '665.22' or cqm.Code = '665.31' or cqm.Code = '665.41' or cqm.Code = '665.51' or cqm.Code = '665.61' or cqm.Code = '665.71' or cqm.Code = '665.72' or cqm.Code = '665.81' or cqm.Code = '665.82' or cqm.Code = '665.91' or cqm.Code = '665.92' or cqm.Code = '666.02' or cqm.Code = '666.12' or cqm.Code = '666.22' or cqm.Code = '666.32' or cqm.Code = '667.02' or cqm.Code = '667.12' or cqm.Code = '668.01' or cqm.Code = '668.02' or cqm.Code = '668.11' or cqm.Code = '668.12' or cqm.Code = '668.21' or cqm.Code = '668.22' or cqm.Code = '668.81' or cqm.Code = '668.82' or cqm.Code = '668.91' or cqm.Code = '668.92' or cqm.Code = '669.01' or cqm.Code = '669.02' or cqm.Code = '669.11' or cqm.Code = '669.12' or cqm.Code = '669.21' or cqm.Code = '669.22' or cqm.Code = '669.32' or cqm.Code = '669.41' or cqm.Code = '669.42' or cqm.Code = '669.51' or cqm.Code = '669.61' or cqm.Code = '669.71' or cqm.Code = '669.81' or cqm.Code = '669.82' or cqm.Code = '669.91' or cqm.Code = '669.92' or cqm.Code = '670.02' or cqm.Code = '671.01' or cqm.Code = '671.02' or cqm.Code = '671.11' or cqm.Code = '671.12' or cqm.Code = '671.21' or cqm.Code = '671.22' or cqm.Code = '671.31' or cqm.Code = '671.42' or cqm.Code = '671.51' or cqm.Code = '671.52' or cqm.Code = '671.81' or cqm.Code = '671.82' or cqm.Code = '671.91' or cqm.Code = '671.92' or cqm.Code = '672.02' or cqm.Code = '673.01' or cqm.Code = '673.02' or cqm.Code = '673.11' or cqm.Code = '673.12' or cqm.Code = '673.21' or cqm.Code = '673.22' or cqm.Code = '673.31' or cqm.Code = '673.32' or cqm.Code = '673.81' or cqm.Code = '673.82' or cqm.Code = '674.01' or cqm.Code = '674.02' or cqm.Code = '674.12' or cqm.Code = '674.22' or cqm.Code = '674.32' or cqm.Code = '674.42' or cqm.Code = '674.51' or cqm.Code = '674.52' or cqm.Code = '674.82' or cqm.Code = '674.92' or cqm.Code = '675.01' or cqm.Code = '675.02' or cqm.Code = '675.11' or cqm.Code = '675.12' or cqm.Code = '675.21' or cqm.Code = '675.22' or cqm.Code = '675.81' or cqm.Code = '675.82' or cqm.Code = '675.91' or cqm.Code = '675.92' or cqm.Code = '676.01' or cqm.Code = '676.02' or cqm.Code = '676.11' or cqm.Code = '676.12' or cqm.Code = '676.21' or cqm.Code = '676.22' or cqm.Code = '676.31' or cqm.Code = '676.32' or cqm.Code = '676.41' or cqm.Code = '676.42' or cqm.Code = '676.51' or cqm.Code = '676.52' or cqm.Code = '676.61' or cqm.Code = '676.62' or cqm.Code = '676.81' or cqm.Code = '676.82' or cqm.Code = '676.91' or cqm.Code = '676.92' or cqm.Code = '678.01' or cqm.Code = '678.11' or cqm.Code = '679.01' or cqm.Code = '679.02' or cqm.Code = '679.11' or cqm.Code = '679.12' or cqm.Code = 'V27.0' or cqm.Code = 'V27.2' or cqm.Code = 'V27.3' or cqm.Code = 'V27.5' or cqm.Code = 'V27.6' or cqm.Code = 'O10.22' or cqm.Code = 'O10.32' or cqm.Code = 'O10.42' or cqm.Code = 'O10.92' or cqm.Code = 'O15.1' or cqm.Code = 'O24.02' or cqm.Code = 'O24.12' or cqm.Code = 'O24.32' or cqm.Code = 'O24.420' or cqm.Code = 'O24.424' or cqm.Code = 'O24.429' or cqm.Code = 'O24.82' or cqm.Code = 'O24.92' or cqm.Code = 'O25.2' or cqm.Code = 'O26.62' or cqm.Code = 'O26.72' or cqm.Code = 'O41.8X25' or cqm.Code = 'O60.10X0' or cqm.Code = 'O60.10X1' or cqm.Code = 'O60.10X2' or cqm.Code = 'O60.10X3' or cqm.Code = 'O60.10X4' or cqm.Code = 'O60.10X5' or cqm.Code = 'O60.10X9' or cqm.Code = 'O60.12X0' or cqm.Code = 'O60.12X1' or cqm.Code = 'O60.12X2' or cqm.Code = 'O60.12X3' or cqm.Code = 'O60.12X4' or cqm.Code = 'O60.12X5' or cqm.Code = 'O60.12X9' or cqm.Code = 'O60.13X0' or cqm.Code = 'O60.13X1' or cqm.Code = 'O60.13X2' or cqm.Code = 'O60.13X3' or cqm.Code = 'O60.13X4' or cqm.Code = 'O60.13X5' or cqm.Code = 'O60.13X9' or cqm.Code = 'O60.14X0' or cqm.Code = 'O60.14X1' or cqm.Code = 'O60.14X2' or cqm.Code = 'O60.14X3' or cqm.Code = 'O60.14X4' or cqm.Code = 'O60.14X5' or cqm.Code = 'O60.14X9' or cqm.Code = 'O60.20X0' or cqm.Code = 'O60.20X1' or cqm.Code = 'O60.20X2' or cqm.Code = 'O60.20X3' or cqm.Code = 'O60.20X4' or cqm.Code = 'O60.20X5' or cqm.Code = 'O60.20X9' or cqm.Code = 'O60.22X0' or cqm.Code = 'O60.22X1' or cqm.Code = 'O60.22X2' or cqm.Code = 'O60.22X3' or cqm.Code = 'O60.22X4' or cqm.Code = 'O60.22X5' or cqm.Code = 'O60.22X9' or cqm.Code = 'O60.23X0' or cqm.Code = 'O60.23X1' or cqm.Code = 'O60.23X2' or cqm.Code = 'O60.23X3' or cqm.Code = 'O60.23X4' or cqm.Code = 'O60.23X5' or cqm.Code = 'O60.23X9' or cqm.Code = 'O61.0' or cqm.Code = 'O61.1' or cqm.Code = 'O61.8' or cqm.Code = 'O61.9' or cqm.Code = 'O62.0' or cqm.Code = 'O62.1' or cqm.Code = 'O62.2' or cqm.Code = 'O62.3' or cqm.Code = 'O62.4' or cqm.Code = 'O62.8' or cqm.Code = 'O62.9' or cqm.Code = 'O63.0' or cqm.Code = 'O63.1' or cqm.Code = 'O63.2' or cqm.Code = 'O63.9' or cqm.Code = 'O64.0XX0' or cqm.Code = 'O64.0XX1' or cqm.Code = 'O64.0XX2' or cqm.Code = 'O64.0XX3' or cqm.Code = 'O64.0XX4' or cqm.Code = 'O64.0XX5' or cqm.Code = 'O64.0XX9' or cqm.Code = 'O64.1XX0' or cqm.Code = 'O64.1XX1' or cqm.Code = 'O64.1XX2' or cqm.Code = 'O64.1XX3' or cqm.Code = 'O64.1XX4' or cqm.Code = 'O64.1XX5' or cqm.Code = 'O64.1XX9' or cqm.Code = 'O64.2XX0' or cqm.Code = 'O64.2XX1' or cqm.Code = 'O64.2XX2' or cqm.Code = 'O64.2XX3' or cqm.Code = 'O64.2XX4' or cqm.Code = 'O64.2XX5' or cqm.Code = 'O64.2XX9' or cqm.Code = 'O64.3XX0' or cqm.Code = 'O64.3XX1' or cqm.Code = 'O64.3XX2' or cqm.Code = 'O64.3XX3' or cqm.Code = 'O64.3XX4' or cqm.Code = 'O64.3XX5' or cqm.Code = 'O64.3XX9' or cqm.Code = 'O64.4XX0' or cqm.Code = 'O64.4XX1' or cqm.Code = 'O64.4XX2' or cqm.Code = 'O64.4XX3' or cqm.Code = 'O64.4XX4' or cqm.Code = 'O64.4XX5' or cqm.Code = 'O64.4XX9' or cqm.Code = 'O64.5XX0' or cqm.Code = 'O64.5XX1' or cqm.Code = 'O64.5XX2' or cqm.Code = 'O64.5XX3' or cqm.Code = 'O64.5XX4' or cqm.Code = 'O64.5XX5' or cqm.Code = 'O64.5XX9' or cqm.Code = 'O64.8XX0' or cqm.Code = 'O64.8XX1' or cqm.Code = 'O64.8XX2' or cqm.Code = 'O64.8XX3' or cqm.Code = 'O64.8XX4' or cqm.Code = 'O64.8XX5' or cqm.Code = 'O64.8XX9' or cqm.Code = 'O64.9XX0' or cqm.Code = 'O64.9XX1' or cqm.Code = 'O64.9XX2' or cqm.Code = 'O64.9XX3' or cqm.Code = 'O64.9XX4' or cqm.Code = 'O64.9XX5' or cqm.Code = 'O64.9XX9' or cqm.Code = 'O65.0' or cqm.Code = 'O65.1' or cqm.Code = 'O65.2' or cqm.Code = 'O65.3' or cqm.Code = 'O65.4' or cqm.Code = 'O65.5' or cqm.Code = 'O65.8' or cqm.Code = 'O65.9' or cqm.Code = 'O66.0' or cqm.Code = 'O66.1' or cqm.Code = 'O66.2' or cqm.Code = 'O66.3' or cqm.Code = 'O66.40' or cqm.Code = 'O66.41' or cqm.Code = 'O66.5' or cqm.Code = 'O66.6' or cqm.Code = 'O66.8' or cqm.Code = 'O66.9' or cqm.Code = 'O68' or cqm.Code = 'O69.0XX0' or cqm.Code = 'O69.0XX1' or cqm.Code = 'O69.0XX2' or cqm.Code = 'O69.0XX3' or cqm.Code = 'O69.0XX4' or cqm.Code = 'O69.0XX5' or cqm.Code = 'O69.0XX9' or cqm.Code = 'O69.1XX0' or cqm.Code = 'O69.1XX1' or cqm.Code = 'O69.1XX2' or cqm.Code = 'O69.1XX3' or cqm.Code = 'O69.1XX4' or cqm.Code = 'O69.1XX5' or cqm.Code = 'O69.1XX9' or cqm.Code = 'O69.2XX0' or cqm.Code = 'O69.2XX1' or cqm.Code = 'O69.2XX2' or cqm.Code = 'O69.2XX3' or cqm.Code = 'O69.2XX4' or cqm.Code = 'O69.2XX5' or cqm.Code = 'O69.2XX9' or cqm.Code = 'O69.3XX0' or cqm.Code = 'O69.3XX1' or cqm.Code = 'O69.3XX2' or cqm.Code = 'O69.3XX3' or cqm.Code = 'O69.3XX4' or cqm.Code = 'O69.3XX5' or cqm.Code = 'O69.3XX9' or cqm.Code = 'O69.4XX0' or cqm.Code = 'O69.4XX1' or cqm.Code = 'O69.4XX2' or cqm.Code = 'O69.4XX3' or cqm.Code = 'O69.4XX4' or cqm.Code = 'O69.4XX5' or cqm.Code = 'O69.4XX9' or cqm.Code = 'O69.5XX0' or cqm.Code = 'O69.5XX1' or cqm.Code = 'O69.5XX2' or cqm.Code = 'O69.5XX3' or cqm.Code = 'O69.5XX4' or cqm.Code = 'O69.5XX5' or cqm.Code = 'O69.5XX9' or cqm.Code = 'O69.81X0' or cqm.Code = 'O69.81X1' or cqm.Code = 'O69.81X2' or cqm.Code = 'O69.81X3' or cqm.Code = 'O69.81X4' or cqm.Code = 'O69.81X5' or cqm.Code = 'O69.81X9' or cqm.Code = 'O69.82X0' or cqm.Code = 'O69.82X1' or cqm.Code = 'O69.82X2' or cqm.Code = 'O69.82X3' or cqm.Code = 'O69.82X4' or cqm.Code = 'O69.82X5' or cqm.Code = 'O69.82X9' or cqm.Code = 'O69.89X0' or cqm.Code = 'O69.89X1' or cqm.Code = 'O69.89X2' or cqm.Code = 'O69.89X3' or cqm.Code = 'O69.89X4' or cqm.Code = 'O69.89X5' or cqm.Code = 'O69.89X9' or cqm.Code = 'O69.9XX0' or cqm.Code = 'O69.9XX1' or cqm.Code = 'O69.9XX2' or cqm.Code = 'O69.9XX3' or cqm.Code = 'O69.9XX4' or cqm.Code = 'O69.9XX5' or cqm.Code = 'O69.9XX9' or cqm.Code = 'O70.0' or cqm.Code = 'O70.1' or cqm.Code = 'O70.2' or cqm.Code = 'O70.3' or cqm.Code = 'O70.4' or cqm.Code = 'O70.9' or cqm.Code = 'O71.00' or cqm.Code = 'O71.02' or cqm.Code = 'O71.03' or cqm.Code = 'O71.1' or cqm.Code = 'O71.2' or cqm.Code = 'O74.1' or cqm.Code = 'O74.2' or cqm.Code = 'O74.3' or cqm.Code = 'O74.4' or cqm.Code = 'O74.7' or cqm.Code = 'O74.9' or cqm.Code = 'O75.0' or cqm.Code = 'O75.1' or cqm.Code = 'O75.5' or cqm.Code = 'O75.81' or cqm.Code = 'O75.82' or cqm.Code = 'O75.89' or cqm.Code = 'O75.9' or cqm.Code = 'O76' or cqm.Code = 'O77.0' or cqm.Code = 'O77.8' or cqm.Code = 'O77.9' or cqm.Code = 'O80' or cqm.Code = 'O82' or cqm.Code = 'O88.02' or cqm.Code = 'O88.12' or cqm.Code = 'O88.22' or cqm.Code = 'O88.32' or cqm.Code = 'O88.82' or cqm.Code = 'O98.02' or cqm.Code = 'O98.12' or cqm.Code = 'O98.22' or cqm.Code = 'O98.32' or cqm.Code = 'O98.42' or cqm.Code = 'O98.52' or cqm.Code = 'O98.62' or cqm.Code = 'O98.72' or cqm.Code = 'O98.82' or cqm.Code = 'O98.92' or cqm.Code = 'O99.02' or cqm.Code = 'O99.12' or cqm.Code = 'O99.214' or cqm.Code = 'O99.284' or cqm.Code = 'O99.314' or cqm.Code = 'O99.324' or cqm.Code = 'O99.334' or cqm.Code = 'O99.344' or cqm.Code = 'O99.354' or cqm.Code = 'O99.42' or cqm.Code = 'O99.52' or cqm.Code = 'O99.62' or cqm.Code = 'O99.72' or cqm.Code = 'O99.814' or cqm.Code = 'O99.824' or cqm.Code = 'O99.834' or cqm.Code = 'O99.844' or cqm.Code = 'O9A.12' or cqm.Code = 'O9A.22' or cqm.Code = 'O9A.32' or cqm.Code = 'O9A.42' or cqm.Code = 'O9A.52' or cqm.Code = 'Z37.0' or cqm.Code = 'Z37.2' or cqm.Code = 'Z37.3' or cqm.Code = 'Z37.50' or cqm.Code = 'Z37.51' or cqm.Code = 'Z37.52' or cqm.Code = 'Z37.54' or cqm.Code = 'Z37.59' or cqm.Code = 'Z37.61' or cqm.Code = 'Z37.62' or cqm.Code = 'Z37.63' or cqm.Code = 'Z37.64' or cqm.Code = 'Z37.69' or cqm.Code = 'Z38.00' or cqm.Code = 'Z38.01' or cqm.Code = 'Z38.1' or cqm.Code = 'Z38.2' or cqm.Code = 'Z38.30' or cqm.Code = 'Z38.31' or cqm.Code = 'Z38.4' or cqm.Code = 'Z38.5' or cqm.Code = 'Z38.61' or cqm.Code = 'Z38.62' or cqm.Code = 'Z38.63' or cqm.Code = 'Z38.64' or cqm.Code = 'Z38.65' or cqm.Code = 'Z38.66' or cqm.Code = 'Z38.68' or cqm.Code = 'Z38.69' or cqm.Code = 'Z38.7' or cqm.Code = 'Z38.8' \
	               ) \
	               and  (isNull(cqm.FclId, '') = case when ('"+fclId+"' = '')  then isNull(cqm.FclId, '') else '"+fclId+"' end) and  (isNull(cqm.DctId, '') = case when ('"+dctId+"' = '')  then isNull(cqm.DctId, '') else '"+dctId+"' end) \
            )";

            cqmGuideController.cqmCheck(sql1, function(err, record){

              if(record && record.length > 0)
              {

                cqmGuideController.cqmCheck(sql2, function(err, record){

                  if(record && record.length > 0)
                  {

                    cqmGuideController.cqmCheck(sql3, function(err, record){

                      if(record && record.length > 0)
                      {
                        callback({criteriaName: "Denominator", isCriteriaQualify : true,  message : null});
                      }
                      else if(err)
                      {
                        callback({criteriaName: "Denominator", isCriteriaQualify : false,  message : err});
                      }
                      else
                      {
                        callback({criteriaName: "Denominator", isCriteriaQualify : false,  message : "Diagnosis, Active: Delivery missing. And Active: Delivery and Delivery Procedure should be on same day."});
                      }

                    });
                  }
                  else if(err)
                  {
                    callback({criteriaName: "Denominator", isCriteriaQualify : false,  message : err});
                  }
                  else
                  {
                    callback({criteriaName: "Denominator", isCriteriaQualify : false,  message : "Most Recent: Delivery Procedure during Measurement Period"});
                  }

                });
              }
              else if(err)
              {
                callback({criteriaName: "Denominator", isCriteriaQualify : false,  message : err});
              }
              else
              {
                callback({criteriaName: "Denominator", isCriteriaQualify : false, message : null});
              }

            });

};
